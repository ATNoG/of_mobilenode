<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
	<link rel="stylesheet" href="style.css" type="text/css">
	<title>of_mobilenode</title>
	<h1>of_mobilenode</h1>
	<h3>Fl&aacute;vio Meneses, Daniel Corujo, Carlos Guimar&atilde;es, Rui Aguiar</h3>
	<hr>
	<div><p class="copyright">Copyright &#169; 2015 Universidade Aveiro</p></div>
<div><p class="copyright">Copyright &#169; 2015 Instituto de Telecomunica&#231;&#245;es - P&#243;lo Aveiro</p></div>
<div><div class="legalnotice">
        <p>This software is distributed under a license. The full license agreement
        can be found in the LICENSE in this distribution. This software may not be
        copied, modified, sold or distributed other than expressed in the named license
        agreement. This software is distributed without any warranty.</p>
</div></div>
<hr>
</head>
<body>
<h1>Getting Started</h1>
<h3>1. Installation</h3>
<p>In this project we did not developed new software, instead we use explore the configuration of softwares already develop and distribuited as open-source. So, instead of presenting how to do the installation we will rather present the needed configuration to reproduce an experience.</p>

<h3>2. Required Software</h3>
<p>With the purpose of extending the OpenFlow control path up to the mobile node, the OvS with its dependencies was installed in every network node, except on the controller node, where the POX was used as the OpenFlow agent in that node.</p>

<h4>2.1 Open vSwitch</h4>
<p>Since we do not develop or change the OvS software, here we will not explain the its installation, rather we will just explain how the configuration was done. 
To install you can follow the steps presented on Open vSwitch <a href="https://github.com/openvswitch/ovs" target="_blank">github</a>.</p>

<p><b>2.1.1. OvS configuration</b></p>
<p><b>a) Router, APs and Listener</b></p>
<p>This example was used to configure the Router node. The remain nodes configuration is similar, keeping in mind that is necessary to change to the respectives network interfaces and IP addresses. It is also important to set the connection mode of the controller to out-of-band. The configuration of the mobile nodes shows how this can be done.</p>
<p>The follow command line enable the packets forwarding, and it is necessary to allow the router and APs nodes forward the receiving packets.</p>
<p>echo 1 > /proc/sys/net/ipv4/ip_forward</p>


<div class="toc">
<br>
# add bridge to ethernet interfaces<br>
ovs-vsctl add-br router<br>
<br>
# attach interfaces to bridges<br>
ovs-vsctl add-port router control.4<br>
<br>
# connect OVS to a controller - "in-band"<br>
ovs-vsctl set-controller router tcp:10.10.10.201:6633<br>
<br>
# set attached interfaces in promiscous mode<br>
ifconfig control.4 0 up<br>
<br>
# start ovs bridges<br>
ifconfig router 192.168.10.254 netmask 255.255.255.0 up<br>
<br>
</div>


<p><b>b) Mobile Node</b></p>
<div class="toc">
<br>
# add bridge to ethernet interfaces<br>
ovs-vsctl add-br br0<br>
ovs-vsctl add-br br1<br>
<br>
# attach interfaces to bridges<br>
ovs-vsctl add-port br0 ath0<br>
ovs-vsctl add-port br1 ath1<br>
<br>
# create a patch port for each bridge<br>
ovs-vsctl add-port br0 patch01 -- set interface patch01 type=patch options:peer=patch10<br>
ovs-vsctl add-port br1 patch10 -- set interface patch10 type=patch options:peer=patch01<br>
<br>
# connect OVS to a controller - "out-of-band"<br>
ovs-vsctl set-controller br0 tcp:10.10.15.201:6633<br>
ovs-vsctl set-controller br1 tcp:10.10.10.201:6633<br>
ovs-vsctl set controller br0 connection-mode=out-of-band<br>
ovs-vsctl set controller br1 connection-mode=out-of-band<br>
ovs-vsctl set bridge br0 other-config:disable-in-band=true<br>
ovs-vsctl set bridge br1 other-config:disable-in-band=true<br>
<br>
# set attached interfaces in promiscous mode<br>
ifconfig ath0 0 up<br>
ifconfig ath1 0 up<br>
<br>
# start ovs bridges<br>
ifconfig br0 192.168.11.1 netmask 255.255.255.0 up<br>
ifconfig br1 192.168.12.1 netmask 255.255.255.0 up<br>
<br>
</div>

<h4>2.2. POX</h4>
<p>As OpenFlow controller we choose POX. But if you are more familiar with another controller it can be also done. However you need to create a script capable to handle the handover trigger form the user device, and change some code in order to avoid the controller ereasing the OvS flow rules when a new connection is establish.</p>  
<p>If you decide to use POX, you can download it form our <a href="https://github.com/ATNoG/of_mobilenode" target="_blank">github</a> with the necessary changes already done, or download it from the <a href="https://github.com/noxrepo/pox" target="_blank">oficial</a> developer and do yourself the changes.</p>

<p><b>a) How to run POX</b></p>
<p>POX officially requires Python 2.7 (though much of it will work fine fine with Python 2.6), and should run under Linux, Mac OS, and Windows.</p>

<div class="toc">
<br>The script ext/handover_mn.py handles the Mobile Node handover request. Run it along with l3_learning<br>
<br>
* You can run with the "py" component and use the CLI:<br>
  ./pox.py forwarding.l3_learning handover_mn py<br>
<br>
The script ext/handover_mn_rules.py handles the Mobile Node handover request while implementes a certain number of dummy rules. As in the script before, run it along with l3_learning<br>
<br>* You can run with the "py" component and use the CLI:
<br>./pox.py forwarding.l3_learning handover_mn_rules py
<br><br>
</div>
<h3>3. Running a demo</h3>

</body>
<footer>
<hr>
	foot
</footer>
</html>